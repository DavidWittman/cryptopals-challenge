package set_four

import (
	"bytes"
	"testing"
)

func TestSHA1Pad(t *testing.T) {
	// From https://www.whitehatsec.com/blog/hash-length-extension-attacks/
	message := []byte("xxxxxxxxxxxreport.pdf")
	expected := []byte{
		0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x78, 0x72, 0x65, 0x70, 0x6f, 0x72, 0x74, 0x2e, 0x70, 0x64, 0x66, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa8,
	}
	result := SHA1Pad(message)
	if bytes.Compare(result, expected) != 0 {
		t.Errorf("\nExpected:\t%x\nGot:\t\t%x", expected, result)
	}
}
